export struct QueryResult {
    column1: string,
    column2: string,
    column3: string,
}

export component AppWindow inherits Window {
    title: "Oracle Query Console";
    width: 1024px;
    height: 640px;

    in-out property <string> host;
    in-out property <string> port;
    in-out property <string> service;
    in-out property <string> user;
    in-out property <string> query;
    in-out property <string> status;
    in-out property <[QueryResult]> results;

    callback run_query();

    background: #0f172a;

    VerticalLayout {
        padding: 16px;
        spacing: 16px;

        Rectangle {
            height: 64px;
            background: #111827;
            border-radius: 12px;

            HorizontalLayout {
                spacing: 16px;
                padding: 12px;

                Text {
                    text: "TOAD for Oracle (Rust + Slint)";
                    color: #f9fafb;
                    font-size: 22px;
                    font-weight: 700;
                }

                Rectangle { width: 1px; background: #374151; }

                Text {
                    text: root.status;
                    color: #93c5fd;
                    font-size: 14px;
                }
            }
        }

        HorizontalLayout {
            spacing: 16px;

            Rectangle {
                width: 320px;
                background: #111827;
                border-radius: 12px;
                padding: 16px;

                VerticalLayout {
                    spacing: 12px;

                    Text {
                        text: "Connection";
                        color: #f3f4f6;
                        font-size: 16px;
                        font-weight: 600;
                    }

                    TextInput {
                        text: root.host;
                        placeholder-text: "Host (ex: db.company.com)";
                    }

                    TextInput {
                        text: root.port;
                        placeholder-text: "Port (ex: 1521)";
                    }

                    TextInput {
                        text: root.service;
                        placeholder-text: "Service / SID";
                    }

                    TextInput {
                        text: root.user;
                        placeholder-text: "User";
                    }

                    HorizontalLayout {
                        spacing: 8px;

                        Button {
                            text: "Connect";
                            background: #2563eb;
                            clicked => { root.status = "Connected (mock)"; }
                        }

                        Button {
                            text: "Disconnect";
                            background: #374151;
                            clicked => { root.status = "Disconnected"; }
                        }
                    }

                    Rectangle { height: 1px; background: #1f2937; }

                    Text {
                        text: "History";
                        color: #9ca3af;
                        font-size: 13px;
                    }

                    ListView {
                        height: 160px;
                        for history in ["select * from users", "select count(*) from orders", "select sysdate from dual"] : Text {
                            text: history;
                            color: #e5e7eb;
                            font-size: 12px;
                        }
                    }
                }
            }

            Rectangle {
                background: #111827;
                border-radius: 12px;
                padding: 16px;

                VerticalLayout {
                    spacing: 12px;

                    Text {
                        text: "SQL Editor";
                        color: #f3f4f6;
                        font-size: 16px;
                        font-weight: 600;
                    }

                    TextInput {
                        text: root.query;
                        placeholder-text: "Write your SQL here...";
                        font-family: "JetBrains Mono";
                        font-size: 13px;
                        height: 120px;
                    }

                    HorizontalLayout {
                        spacing: 8px;

                        Button {
                            text: "Run";
                            background: #16a34a;
                            clicked => { root.run_query(); }
                        }

                        Button {
                            text: "Explain Plan";
                            background: #475569;
                            clicked => { root.status = "Explain plan generated (mock)"; }
                        }

                        Button {
                            text: "Export";
                            background: #334155;
                            clicked => { root.status = "Exported to CSV (mock)"; }
                        }
                    }

                    Rectangle { height: 1px; background: #1f2937; }

                    Text {
                        text: "Results";
                        color: #f3f4f6;
                        font-size: 14px;
                        font-weight: 600;
                    }

                    Rectangle {
                        height: 36px;
                        background: #0f172a;
                        border-radius: 6px;
                        HorizontalLayout {
                            padding: 8px;
                            spacing: 12px;
                            Text { text: "COLUMN_1"; color: #93c5fd; font-size: 12px; }
                            Text { text: "COLUMN_2"; color: #93c5fd; font-size: 12px; }
                            Text { text: "COLUMN_3"; color: #93c5fd; font-size: 12px; }
                        }
                    }

                    ListView {
                        height: 240px;
                        for result in root.results : Rectangle {
                            height: 32px;
                            background: index % 2 == 0 ? #111827 : #0b1220;
                            HorizontalLayout {
                                padding: 8px;
                                spacing: 12px;
                                Text { text: result.column1; color: #e5e7eb; font-size: 12px; }
                                Text { text: result.column2; color: #e5e7eb; font-size: 12px; }
                                Text { text: result.column3; color: #e5e7eb; font-size: 12px; }
                            }
                        }
                    }
                }
            }
        }
    }
}
